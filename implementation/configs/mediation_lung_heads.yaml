project:
  name: scgpt-mediation-lung-heads
  seed: 42

paths:
  scgpt_repo: external/scGPT
  scgpt_checkpoint: external/scGPT_checkpoints/whole-human/best_model.pt
  scgpt_vocab: external/scGPT_checkpoints/whole-human/vocab.json
  tabula_sapiens_h5ad: data/raw/tabula_sapiens_lung.h5ad
  gene_info_csv: external/gene_info.csv
  hgnc_alias_tsv: external/hgnc_complete_set.txt
  processed_h5ad: ../subproject_09_causal_mediation_circuit_map/implementation/results/preprocessed/tabula_sapiens_lung_processed.h5ad
  dorothea_tsv: external/networks/trrust_human.tsv
  causal_output_dir: ../subproject_09_causal_mediation_circuit_map/implementation/results/lung/heads

preprocess:
  min_genes: 200
  min_cells: 3
  normalize_total: 10000
  log1p: true
  hvg: 5000

scgpt_dataset:
  max_genes: 1200
  include_zero: false
  sort_by_expression: true
  pad_token_id: null
  cls_token_id: null

model:
  entrypoint: scgpt.model.TransformerModel
  model_args: {}
  prefix_to_strip: null
  forward_key_map:
    gene_ids: src
    gene_values: values
    src_key_padding_mask: src_key_padding_mask

evaluation:
  dorothea_confidence:
    - A
    - B
    - C
    - D

causal_intervention:
  output_dir: ../subproject_09_causal_mediation_circuit_map/implementation/results/lung/heads
  max_cells: 24
  max_cells_per_pair: 8
  batch_size: 1
  disable_fast_transformer: true
  torch_num_threads: 1
  torch_num_interop_threads: 1
  resume: false
  checkpoint_path: ../subproject_09_causal_mediation_circuit_map/implementation/results/lung/heads/checkpoint.json
  checkpoint_every_pairs: 1
  progress_every_pairs: 1
  interventions:
    - ablation
    - swap
  ablation_mode: value
  baseline_value: 0.0
  swap_strategy: random
  output_key: null
  output_reduce: mean
  max_pairs: 0
  random_control_pairs: 0
  random_seed: 42
  candidate_sources_path: null
  candidate_targets_path: null
  pairs_path: ../subproject_09_causal_mediation_circuit_map/implementation/configs/pairs_case_studies.tsv
  primary_intervention: ablation
  case_study_count: 5
  case_study_component_count: 8
  score_mode: abs
  tracing:
    enabled: true
    granularity: attention_head
    max_heads_per_layer: 2
    patch_position: source
    normalize_restoration: true
    pairs_path: ../subproject_09_causal_mediation_circuit_map/implementation/configs/pairs_case_studies.tsv
